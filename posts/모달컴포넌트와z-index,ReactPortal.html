<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><link rel="apple-touch-icon" href="%PUBLIC_URL%/logo.svg"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>모달 컴포넌트와 z-index, React Portal</title><meta name="title" content="모달 컴포넌트와 z-index, React Portal"/><meta name="keywords" content="FE, ReactJS, NextJS, javascript, typescript"/><meta name="description" content="현재 프로젝트에서 사용되고 있던 모달 컴포넌트를 알아보고, React Portal을 사용하여 개선해보자"/><meta http-equiv="Title" content="모달 컴포넌트와 z-index, React Portal"/><meta http-equiv="Subject" content="현재 프로젝트에서 사용되고 있던 모달 컴포넌트를 알아보고, React Portal을 사용하여 개선해보자"/><meta property="og:type" content="article"/><meta property="og:url" content="https://jangky000.github.io"/><meta property="og:title" content="모달 컴포넌트와 z-index, React Portal"/><meta property="og:image" content="https://user-images.githubusercontent.com/46799722/170039589-53960bc6-5d7c-4558-a752-1a426e63b7d5.png"/><meta property="og:description" content="현재 프로젝트에서 사용되고 있던 모달 컴포넌트를 알아보고, React Portal을 사용하여 개선해보자"/><meta property="og:site_name" content="FE는 철"/><meta property="og:locale" content="ko_KR"/><meta property="og:image:width" content="316"/><meta property="og:image:height" content="562"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="모달 컴포넌트와 z-index, React Portal"/><meta name="twitter:description" content="현재 프로젝트에서 사용되고 있던 모달 컴포넌트를 알아보고, React Portal을 사용하여 개선해보자"/><meta name="twitter:image" content="https://user-images.githubusercontent.com/46799722/170039589-53960bc6-5d7c-4558-a752-1a426e63b7d5.png"/><meta name="next-head-count" content="23"/><meta name="google-site-verification" content="DPsgjCONuCmXo7g20zSkClsSwOef21VzS4Ihvwgjna0"/><meta name="naver-site-verification" content="e5e67bc35f28f45a7fcf3ee3ea2f5b081ea5ad87"/><link rel="preload" href="/_next/static/css/3f081657a0e1e97c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/3f081657a0e1e97c.css" data-n-g=""/><link rel="preload" href="/_next/static/css/cb5a7feca3fcc903.css" as="style"/><link rel="stylesheet" href="/_next/static/css/cb5a7feca3fcc903.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-dc9b5fe4736780d1.js" defer=""></script><script src="/_next/static/chunks/framework-beeb81ad8570a989.js" defer=""></script><script src="/_next/static/chunks/main-6057cf5d137ac113.js" defer=""></script><script src="/_next/static/chunks/pages/_app-e80974514508b350.js" defer=""></script><script src="/_next/static/chunks/ea88be26-3a3d5e1902b6f677.js" defer=""></script><script src="/_next/static/chunks/689-21aad9bb91ba8b27.js" defer=""></script><script src="/_next/static/chunks/920-f0105d192cf6e544.js" defer=""></script><script src="/_next/static/chunks/46-545578ec1db3644e.js" defer=""></script><script src="/_next/static/chunks/107-4805ee4300a0d61e.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Btitle%5D-a098b202ee45d413.js" defer=""></script><script src="/_next/static/bQcpHPUJVgYV3XLMVBb_b/_buildManifest.js" defer=""></script><script src="/_next/static/bQcpHPUJVgYV3XLMVBb_b/_ssgManifest.js" defer=""></script><style id="__jsx-a6af0e2473afc2ae">footer.jsx-a6af0e2473afc2ae{-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;border-top:1px solid#eaeaea;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:20px;width:100%}.copyright.jsx-a6af0e2473afc2ae{margin-bottom:12px}.hits.jsx-a6af0e2473afc2ae{margin-bottom:8px}</style></head><body><div id="__next"><div class="Posts_container__VfzHC"><style data-emotion="css 162alkr-scroll-progress-bar">.css-162alkr-scroll-progress-bar{position:fixed;top:0;left:0;width:100%;height:3px;background:linear-gradient(
    110deg,
    red,
    orange,
    yellow,
    green,
    indigo,
    purple,
    black
  );opacity:0.5;z-index:10;}.css-162alkr-scroll-progress-bar .bar{position:absolute;top:0;right:0;width:100%;height:3px;background:#fff;}</style><div class="css-162alkr-scroll-progress-bar"><div class="bar" style="width:100%"></div></div><style data-emotion="css 1eou086">.css-1eou086{width:90%;max-width:850px;margin:0 auto;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-1eou086 .theme-switch{-webkit-align-self:flex-end;-ms-flex-item-align:flex-end;align-self:flex-end;}.css-1eou086 .wrapper{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:#fff;border-bottom:1px solid #ddd;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:140px;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding:0 16px;position:relative;}.css-1eou086 .lottie-wrapper{position:absolute;top:0;bottom:0;left:0;right:0;opacity:0.7;}.css-1eou086 .title{margin-bottom:12px;z-index:1;color:#000;}.css-1eou086 b{font-size:1.4rem;font-weight:bold;}.css-1eou086 .desc{color:#333;font-size:0.9rem;margin-top:0.5rem;}.css-1eou086 a{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;}</style><header class="css-1eou086"><style data-emotion="css ecvcn9">.css-ecvcn9{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;width:58px;height:38px;overflow:hidden;padding:12px;box-sizing:border-box;position:relative;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;z-index:0;vertical-align:middle;}@media print{.css-ecvcn9{-webkit-print-color-adjust:exact;color-adjust:exact;}}</style><span class="MuiSwitch-root MuiSwitch-sizeMedium theme-switch css-ecvcn9"><style data-emotion="css jl41ik">.css-jl41ik{position:absolute;top:0;left:0;z-index:1;color:#fff;-webkit-transition:left 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,-webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:left 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,transform 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-jl41ik.Mui-checked{-webkit-transform:translateX(20px);-moz-transform:translateX(20px);-ms-transform:translateX(20px);transform:translateX(20px);}.css-jl41ik.Mui-disabled{color:#f5f5f5;}.css-jl41ik.Mui-checked+.MuiSwitch-track{opacity:0.5;}.css-jl41ik.Mui-disabled+.MuiSwitch-track{opacity:0.12;}.css-jl41ik .MuiSwitch-input{left:-100%;width:300%;}.css-jl41ik:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-jl41ik:hover{background-color:transparent;}}.css-jl41ik.Mui-checked{color:#556cd6;}.css-jl41ik.Mui-checked:hover{background-color:rgba(85, 108, 214, 0.04);}@media (hover: none){.css-jl41ik.Mui-checked:hover{background-color:transparent;}}.css-jl41ik.Mui-checked.Mui-disabled{color:rgb(190, 199, 239);}.css-jl41ik.Mui-checked+.MuiSwitch-track{background-color:#556cd6;}</style><style data-emotion="css niqsiq">.css-niqsiq{padding:9px;border-radius:50%;position:absolute;top:0;left:0;z-index:1;color:#fff;-webkit-transition:left 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,-webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:left 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,transform 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-niqsiq.Mui-checked{-webkit-transform:translateX(20px);-moz-transform:translateX(20px);-ms-transform:translateX(20px);transform:translateX(20px);}.css-niqsiq.Mui-disabled{color:#f5f5f5;}.css-niqsiq.Mui-checked+.MuiSwitch-track{opacity:0.5;}.css-niqsiq.Mui-disabled+.MuiSwitch-track{opacity:0.12;}.css-niqsiq .MuiSwitch-input{left:-100%;width:300%;}.css-niqsiq:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-niqsiq:hover{background-color:transparent;}}.css-niqsiq.Mui-checked{color:#556cd6;}.css-niqsiq.Mui-checked:hover{background-color:rgba(85, 108, 214, 0.04);}@media (hover: none){.css-niqsiq.Mui-checked:hover{background-color:transparent;}}.css-niqsiq.Mui-checked.Mui-disabled{color:rgb(190, 199, 239);}.css-niqsiq.Mui-checked+.MuiSwitch-track{background-color:#556cd6;}</style><style data-emotion="css wvvgvo">.css-wvvgvo{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;padding:9px;border-radius:50%;position:absolute;top:0;left:0;z-index:1;color:#fff;-webkit-transition:left 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,-webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:left 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,transform 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-wvvgvo::-moz-focus-inner{border-style:none;}.css-wvvgvo.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-wvvgvo{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-wvvgvo.Mui-checked{-webkit-transform:translateX(20px);-moz-transform:translateX(20px);-ms-transform:translateX(20px);transform:translateX(20px);}.css-wvvgvo.Mui-disabled{color:#f5f5f5;}.css-wvvgvo.Mui-checked+.MuiSwitch-track{opacity:0.5;}.css-wvvgvo.Mui-disabled+.MuiSwitch-track{opacity:0.12;}.css-wvvgvo .MuiSwitch-input{left:-100%;width:300%;}.css-wvvgvo:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-wvvgvo:hover{background-color:transparent;}}.css-wvvgvo.Mui-checked{color:#556cd6;}.css-wvvgvo.Mui-checked:hover{background-color:rgba(85, 108, 214, 0.04);}@media (hover: none){.css-wvvgvo.Mui-checked:hover{background-color:transparent;}}.css-wvvgvo.Mui-checked.Mui-disabled{color:rgb(190, 199, 239);}.css-wvvgvo.Mui-checked+.MuiSwitch-track{background-color:#556cd6;}</style><span class="MuiButtonBase-root MuiSwitch-switchBase MuiSwitch-colorPrimary PrivateSwitchBase-root MuiSwitch-switchBase MuiSwitch-colorPrimary css-wvvgvo"><style data-emotion="css 1m9pwf3">.css-1m9pwf3{cursor:inherit;position:absolute;opacity:0;width:100%;height:100%;top:0;left:0;margin:0;padding:0;z-index:1;}</style><input class="PrivateSwitchBase-input MuiSwitch-input css-1m9pwf3" type="checkbox"/><style data-emotion="css 19gndve">.css-19gndve{box-shadow:0px 2px 1px -1px rgba(0,0,0,0.2),0px 1px 1px 0px rgba(0,0,0,0.14),0px 1px 3px 0px rgba(0,0,0,0.12);background-color:currentColor;width:20px;height:20px;border-radius:50%;}</style><span class="MuiSwitch-thumb css-19gndve"></span></span><style data-emotion="css 1ju1kxc">.css-1ju1kxc{height:100%;width:100%;border-radius:7px;z-index:-1;-webkit-transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;background-color:#000;opacity:0.38;}</style><span class="MuiSwitch-track css-1ju1kxc"></span></span><div class="wrapper"><div class="lottie-wrapper"><style data-emotion="css 1gybl1y-styled-lottie">.css-1gybl1y-styled-lottie{width:100%;height:100%;}</style><div width="100%" height="100%" class="css-1gybl1y-styled-lottie"></div></div><div class="title"><style data-emotion="css dtw560">.css-dtw560{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;}</style><a class="css-dtw560" href="/"><style data-emotion="css kcbsw7-styled-lottie">.css-kcbsw7-styled-lottie{width:70px;height:70px;}</style><div width="70px" height="70px" class="css-kcbsw7-styled-lottie"></div><b>FE는 철</b></a><div class="desc">FE 개발자로 일하면서 겪은 경험담을 정리합니다.</div></div></div></header><div style="opacity:0"><style data-emotion="css 674psz-post-layout">.css-674psz-post-layout{margin:30px auto;max-width:850px;width:90%;}.css-674psz-post-layout img{max-width:100%;}.css-674psz-post-layout .post-desc{border-radius:4px;background-color:#BDCC94;padding:20px;margin:20px auto;color:#FFFFFF;font-size:1.1rem;}.css-674psz-post-layout .post-contents a{color:#95998A;-webkit-text-decoration:underline;text-decoration:underline;}.css-674psz-post-layout .post-contents a:hover{color:#000;cursor:pointer;}.css-674psz-post-layout .post-contents code{background:rgba(135, 131, 120, 0.15);color:#eb5757;border-radius:3px;font-size:85%;padding:0.2em 0.4em;}</style><main class="css-674psz-post-layout"><div><h2>모달 컴포넌트와 z-index, React Portal</h2></div><small>2022.02.22<!-- --> 작성 / @<!-- -->jangky000</small><hr/><div class="post-desc">현재 프로젝트에서 사용되고 있던 모달 컴포넌트를 알아보고, React Portal을 사용하여 개선해보자</div><div class="post-contents"><h1>모달 컴포넌트</h1><p>여기서 말하고자 하는 모달창은 어떠한 사용자의 행동에 대한 응답으로 화면의 최상단에 띄워져야 할 윈도우 창이 아닌 레이어를 말한다. 가장 최상단에 html 요소를 표현하기 위해서는 z-index라는 css 속성을 이해할 필요가 있다.</p><h2>z-index의 특징</h2><p>z-index 속성의 가장 큰 특징은 부모 element의 z-index가 다른 형제 element들의 z-index보다 낮을 때, 아무리 자식 element의 z-index 값을 크게 해도 최상단에 보이지 않는다는 점이다. 이는 쌓임맥락(Stacking Context)을 참고하면 이해가 될 것이다.(참고: <a href="https://developer.mozilla.org/ko/docs/Web/CSS/CSS_Positioning/Understanding_z_index/The_stacking_context">쌓임맥락</a>)</p><h2>기존 모달 컴포넌트</h2><p>기존에 프로젝트에서 사용되고 있는 모달 컴포넌트 역시 이 z-index로 인한 고민이 있었을 것이다. 특히 컴포넌트 단위로 개발하는 리액트의 작업 방식의 특성상, 모달 컴포넌트가 어떤 z-index를 가진 컴포넌트 내부에서 사용될지 알 수 없기 때문에 z-index의 설정에 대한 고민이 있었을 것이다.</p><h2>기존 모달 컴포넌트 구현 방식</h2><p>부모 element의 z-index에 영향을 받지 않기 위해, Route 아래에서 GlobalModal 컴포넌트를 아래와 같이 선언했다. 그리고 전역 상태로 모달창을 켜고 끄게 설계되었다.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-tsx" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#DD4A68">Switch</span><span class="token" style="color:#999">&gt;</span><span class="token plain-text">
</span><span class="token plain-text">  </span><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#DD4A68">Route</span><span class="token" style="color:#905"> </span><span class="token" style="color:#690">exact</span><span class="token" style="color:#905"> </span><span class="token" style="color:#690">path</span><span class="token attr-equals" style="color:#999">=</span><span class="token" style="color:#999">&quot;</span><span class="token" style="color:#07a">/...</span><span class="token" style="color:#999">&quot;</span><span class="token" style="color:#905"> </span><span class="token" style="color:#690">component</span><span class="token script language-javascript script-punctuation" style="color:#905">=</span><span class="token script language-javascript" style="color:#999">{</span><span class="token script language-javascript spread" style="color:#905">...</span><span class="token script language-javascript" style="color:#999">}</span><span class="token" style="color:#905"> </span><span class="token" style="color:#999">/&gt;</span><span class="token plain-text">
</span><span class="token plain-text">	...
</span><span class="token plain-text"></span><span class="token" style="color:#999">&lt;/</span><span class="token" style="color:#DD4A68">Switch</span><span class="token" style="color:#999">&gt;</span><span>
</span><span></span><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#DD4A68">GlobalModal</span><span class="token" style="color:#905"> </span><span class="token" style="color:#999">/&gt;</span></code></pre><h2>기존 모달 컴포넌트의 문제점</h2><ol><li>가장 큰 문제점은 모달 컴포넌트 자체에서 background-color: #fff, border-radius: 12px로 고정되어 있는 것이 문제였다. 아래와 같은 디자인을 반영하고 싶어도, 2개의 박스를 표현할 수 없고, 배경 색상을 변경할 수도 없었다. </li></ol><div><img width="70%" alt="1" src="https://user-images.githubusercontent.com/46799722/157811178-4ddc996d-d9f1-4dee-9207-13aa39d55d3b.png">
<img width="25%" alt="2" src="https://user-images.githubusercontent.com/46799722/157811183-1ecfa4a8-0896-461f-87e8-275575b96ad4.png"></div><ol start="2"><li>아래 사용법을 보면 모달 컴포넌트 내부에 들어갈 내용을 컴포넌트로 전달하고 있다. modalStore는 모달의 open, close 전역 상태를 관리하는 mobx의 observable state다. 또한 onClick 이벤트 핸들러 함수 내부에 컴포넌트가 사용되었다. 이에 대해서 핸들러 기능과 컴포넌트 UI의 분리적인 측면에서 개선될 여지가 있다고 생각했다.</li></ol><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-tsx" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// 사용법</span><span>
</span><span></span><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#905">button</span><span class="token" style="color:#905">
</span><span class="token" style="color:#905">  </span><span class="token" style="color:#690">onClick</span><span class="token script language-javascript script-punctuation" style="color:#905">=</span><span class="token script language-javascript" style="color:#999">{</span><span class="token script language-javascript" style="color:#999">(</span><span class="token script language-javascript" style="color:#999">)</span><span class="token script language-javascript" style="color:#905"> </span><span class="token script language-javascript arrow" style="color:#905">=&gt;</span><span class="token script language-javascript" style="color:#905">
</span><span class="token script language-javascript" style="color:#905">    modalStore</span><span class="token script language-javascript" style="color:#999">.</span><span class="token script language-javascript method property-access" style="color:#905">open</span><span class="token script language-javascript" style="color:#999">(</span><span class="token script language-javascript" style="color:#905">
</span><span class="token script language-javascript" style="color:#905">      </span><span class="token script language-javascript" style="color:#999">&lt;</span><span class="token script language-javascript" style="color:#DD4A68">ModalPresenter</span><span class="token script language-javascript" style="color:#905">
</span><span class="token script language-javascript" style="color:#905">        </span><span class="token script language-javascript" style="color:#690">data</span><span class="token script language-javascript script-punctuation" style="color:#905">=</span><span class="token script language-javascript" style="color:#999">{</span><span class="token script language-javascript" style="color:#905">data</span><span class="token script language-javascript" style="color:#999">}</span><span class="token script language-javascript" style="color:#905">
</span><span class="token script language-javascript" style="color:#905">        </span><span class="token script language-javascript" style="color:#690">handleClick</span><span class="token script language-javascript script-punctuation" style="color:#905">=</span><span class="token script language-javascript" style="color:#999">{</span><span class="token script language-javascript" style="color:#999">(</span><span class="token script language-javascript" style="color:#999">)</span><span class="token script language-javascript" style="color:#905"> </span><span class="token script language-javascript arrow" style="color:#905">=&gt;</span><span class="token script language-javascript" style="color:#905"> </span><span class="token script language-javascript spread" style="color:#905">...</span><span class="token script language-javascript" style="color:#999">}</span><span class="token script language-javascript" style="color:#905">
</span><span class="token script language-javascript" style="color:#905">        </span><span class="token script language-javascript" style="color:#690">close</span><span class="token script language-javascript script-punctuation" style="color:#905">=</span><span class="token script language-javascript" style="color:#999">{</span><span class="token script language-javascript" style="color:#999">(</span><span class="token script language-javascript" style="color:#999">)</span><span class="token script language-javascript" style="color:#905"> </span><span class="token script language-javascript arrow" style="color:#905">=&gt;</span><span class="token script language-javascript" style="color:#905"> modalStore</span><span class="token script language-javascript" style="color:#999">.</span><span class="token script language-javascript method property-access" style="color:#905">hide</span><span class="token script language-javascript" style="color:#999">(</span><span class="token script language-javascript" style="color:#999">)</span><span class="token script language-javascript" style="color:#999">}</span><span class="token script language-javascript" style="color:#905">
</span><span class="token script language-javascript" style="color:#905">      </span><span class="token script language-javascript" style="color:#999">/&gt;</span><span class="token script language-javascript" style="color:#999">,</span><span class="token script language-javascript" style="color:#905">
</span><span class="token script language-javascript" style="color:#905">      </span><span class="token script language-javascript" style="color:#999">{</span><span class="token script language-javascript" style="color:#905">
</span><span class="token script language-javascript" style="color:#905">        disableClose</span><span class="token script language-javascript" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span class="token script language-javascript" style="color:#905"> </span><span class="token script language-javascript" style="color:#905">true</span><span class="token script language-javascript" style="color:#999">,</span><span class="token script language-javascript" style="color:#905">
</span><span class="token script language-javascript" style="color:#905">      </span><span class="token script language-javascript" style="color:#999">}</span><span class="token script language-javascript" style="color:#999">,</span><span class="token script language-javascript" style="color:#905">
</span><span class="token script language-javascript" style="color:#905">    </span><span class="token script language-javascript" style="color:#999">)</span><span class="token script language-javascript" style="color:#905">
</span><span class="token script language-javascript" style="color:#905">  </span><span class="token script language-javascript" style="color:#999">}</span><span class="token" style="color:#905">
</span><span class="token" style="color:#905"></span><span class="token" style="color:#999">&gt;</span><span class="token plain-text">
</span><span class="token plain-text">  ...
</span><span class="token plain-text"></span><span class="token" style="color:#999">&lt;/</span><span class="token" style="color:#905">button</span><span class="token" style="color:#999">&gt;</span></code></pre><h2>개선점</h2><p>기존의 모달 컴포넌트는 많은 곳에서 사용되고 있다. 단순히 옵션 추가와 분기 처리만으로도 필요한 디자인을 만들 수 있겠지만, 점점 많아지는 예외적인 분기처리 코드를 의도를 알기 어렵게 만들고 읽기 어렵게 한다는 생각이 든다. 그래서 새롭게 만드는 기능들부터 쉽게 적용 가능하고, 다양하게 쓰일 수 있는 모달 컴포넌트를 제작하기로 했다.</p><ol><li>React 자체 기능인 Portal을 이용하여, 전역 상태 관리를 하지 않고 z-index 문제를 해결한다.(참고: <a href="https://ko.reactjs.org/docs/portals.html">React Portals</a>)</li><li>background-color와 border-radius 속성을 고정하지 않고 children을 통해 자유롭게 전달할 수 있게 한다.</li><li>fade in, fade out 애니메이션을 적용한다.</li></ol><h2>개선 결과: GeneralModalComposition</h2><p>일반적인 컴포넌트가 <code>div#root</code> 내부에 추가되고, Portal을 사용한 컴포넌트는 형제 element인 <code>div#modal-root</code> 내부에 추가된다. 그렇게 되면 <code>div#modal-root</code> 내부에 있는 modal의 z-index는 <code>div#root</code> 내부에 있는 부모 컴포넌트 z-index에 영향을 받지 않는다. 그러므로 modal의 z-index만 값만 고려해서 충분히 할당하면 된다.(여기서는 99)</p><p>여기서 주의할 점은 <code>div#modal-root</code> 내부에 있는 modal에 z-index 값을 주지 않으면, <code>div#root</code> 내부에 있는 z-index가 더 높은 element가 더 상위에 보이게 된다. <code>div#modal-root</code> 내부에 있는 modal이 부모 element의 쌓임맥락에 동화되지 않을 뿐이지 z-index 비교는 그대로 하기 때문이다.</p><div><img width="35%" alt="3" src="https://user-images.githubusercontent.com/46799722/157811185-5f417b2d-73c0-4c32-9b54-111ff7f3d93f.png">
<img width="60%" alt="4" src="https://user-images.githubusercontent.com/46799722/157811188-4993ac48-9b6a-46d4-95f8-0550835928df.png"></div><h2>GeneralModalComposition 사용법</h2><p>버튼의 클릭 이벤트 핸들러와 모달 내부의 컴포넌트가 분리가 되었다. 그리고 전역 상태로 관리하지 않고도 모달 컴포넌트를 최상단에 그릴 수 있게 되었다.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-tsx" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#999">[</span><span>isModalOpen</span><span class="token" style="color:#999">,</span><span> setModalOpen</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useState</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">false</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">const</span><span> handleModalOpen </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useCallback</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#DD4A68">setLegacyPlanModalOpen</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">true</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">const</span><span> handleModalClose </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useCallback</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#DD4A68">setLegacyPlanModalOpen</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">false</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token" style="color:#999">(</span><span>
</span><span>	</span><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#DD4A68">Button</span><span class="token" style="color:#905"> </span><span class="token" style="color:#690">onClick</span><span class="token script language-javascript script-punctuation" style="color:#905">=</span><span class="token script language-javascript" style="color:#999">{</span><span class="token script language-javascript" style="color:#905">handleModalOpen</span><span class="token script language-javascript" style="color:#999">}</span><span class="token" style="color:#999">&gt;</span><span class="token plain-text">모달 열기</span><span class="token" style="color:#999">&lt;/</span><span class="token" style="color:#DD4A68">Button</span><span class="token" style="color:#999">&gt;</span><span>
</span>	
<span>	</span><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#DD4A68">GeneralModalComposition</span><span class="token" style="color:#905"> 
</span><span class="token" style="color:#905">		</span><span class="token" style="color:#690">isOpen</span><span class="token script language-javascript script-punctuation" style="color:#905">=</span><span class="token script language-javascript" style="color:#999">{</span><span class="token script language-javascript" style="color:#905">isModalOpen</span><span class="token script language-javascript" style="color:#999">}</span><span class="token" style="color:#905">
</span><span class="token" style="color:#905">		</span><span class="token" style="color:#690">closeModal</span><span class="token script language-javascript script-punctuation" style="color:#905">=</span><span class="token script language-javascript" style="color:#999">{</span><span class="token script language-javascript" style="color:#905">handleModalClose</span><span class="token script language-javascript" style="color:#999">}</span><span class="token" style="color:#905">
</span><span class="token" style="color:#905">		</span><span class="token" style="color:#690">childrenCss</span><span class="token script language-javascript script-punctuation" style="color:#905">=</span><span class="token script language-javascript" style="color:#999">{</span><span class="token script language-javascript" style="color:#999">{</span><span class="token script language-javascript" style="color:#905"> width</span><span class="token script language-javascript" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span class="token script language-javascript" style="color:#905"> </span><span class="token script language-javascript" style="color:#690">&#x27;1352px&#x27;</span><span class="token script language-javascript" style="color:#999">,</span><span class="token script language-javascript" style="color:#905"> height</span><span class="token script language-javascript" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span class="token script language-javascript" style="color:#905"> </span><span class="token script language-javascript" style="color:#690">&#x27;1607px&#x27;</span><span class="token script language-javascript" style="color:#905"> </span><span class="token script language-javascript" style="color:#999">}</span><span class="token script language-javascript" style="color:#999">}</span><span class="token" style="color:#905"> </span><span class="token" style="color:#690">-</span><span class="token" style="color:#999">&gt;</span><span class="token plain-text"> optional
</span><span class="token plain-text">	&gt;
</span><span class="token plain-text">		</span><span class="token" style="color:#999">{</span><span> 임의의 </span><span class="token maybe-class-name">Modal</span><span> 컴포넌트 </span><span class="token" style="color:#999">}</span><span class="token plain-text">
</span><span class="token plain-text">	</span><span class="token" style="color:#999">&lt;/</span><span class="token" style="color:#DD4A68">GeneralModalComposition</span><span class="token" style="color:#999">&gt;</span><span>
</span><span>	</span><span class="token" style="color:#999">)</span></code></pre><h1>GeneralModalComposition.tsx</h1><p>배경에 Backdrop 추가.
fadeIn, fadeOut animation 적용.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-tsx" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">GeneralModalCompositionProps</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  isOpen</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">boolean</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token function-variable" style="color:#DD4A68">closeModal</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#07a">void</span><span class="token" style="color:#999">;</span><span>
</span><span>  children</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">React</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">ReactNode</span><span class="token" style="color:#999">;</span><span>
</span><span>  childrenCss</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">?</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">React</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">CSSProperties</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:slategray">/**
</span><span class="token" style="color:slategray"> * @description
</span><span class="token" style="color:slategray"> * Composition
</span><span class="token" style="color:slategray"> * @example
</span><span class="token" style="color:slategray"> * &lt;Button onClick={handleModalOpen}&gt;모달 열기&lt;/Button&gt;
</span><span class="token" style="color:slategray"> *
</span><span class="token" style="color:slategray"> * &lt;GeneralModalComposition
</span><span class="token" style="color:slategray">    isOpen={isModalOpen}
</span><span class="token" style="color:slategray">    childrenCss={{ width: &#x27;1352px&#x27;, height: &#x27;1607px&#x27; }}
</span><span class="token" style="color:slategray">    closeModal={handleModalClose}
</span><span class="token" style="color:slategray">  &gt;
</span><span class="token" style="color:slategray"> *  { 임의의 Modal 컴포넌트 }
</span><span class="token" style="color:slategray"> * &lt;/GeneralModalComposition&gt;
</span><span class="token" style="color:slategray"> */</span><span>
</span><span></span><span class="token" style="color:#07a">function</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">GeneralModalComposition</span><span class="token" style="color:#999">(</span><span class="token parameter" style="color:#999">{</span><span class="token parameter"> isOpen</span><span class="token parameter" style="color:#999">,</span><span class="token parameter"> closeModal</span><span class="token parameter" style="color:#999">,</span><span class="token parameter"> children</span><span class="token parameter" style="color:#999">,</span><span class="token parameter"> childrenCss </span><span class="token parameter" style="color:#999">}</span><span class="token parameter" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span class="token parameter"> </span><span class="token parameter maybe-class-name">GeneralModalCompositionProps</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#999">[</span><span>isVisible</span><span class="token" style="color:#999">,</span><span> setVisible</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useState</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">false</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>  </span><span class="token" style="color:#DD4A68">useEffect</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token control-flow" style="color:#07a">if</span><span> </span><span class="token" style="color:#999">(</span><span>isOpen</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>      </span><span class="token" style="color:#DD4A68">setVisible</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">true</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span> </span><span class="token control-flow" style="color:#07a">else</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>      </span><span class="token" style="color:#DD4A68">setTimeout</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#DD4A68">setVisible</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">false</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">100</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span>isOpen</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>  </span><span class="token control-flow" style="color:#07a">if</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">!</span><span>isVisible</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span>
</span>
<span>  </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token" style="color:#999">(</span><span>
</span><span>    </span><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#DD4A68">PortalToModalRootComposition</span><span class="token" style="color:#999">&gt;</span><span class="token plain-text">
</span><span class="token plain-text">      </span><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#DD4A68">StyledGeneralModal</span><span class="token" style="color:#905"> </span><span class="token" style="color:#690">isOpen</span><span class="token script language-javascript script-punctuation" style="color:#905">=</span><span class="token script language-javascript" style="color:#999">{</span><span class="token script language-javascript" style="color:#905">isOpen</span><span class="token script language-javascript" style="color:#999">}</span><span class="token" style="color:#999">&gt;</span><span class="token plain-text">
</span><span class="token plain-text">        </span><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#DD4A68">Backdrop</span><span class="token" style="color:#905"> </span><span class="token" style="color:#690">handleClick</span><span class="token script language-javascript script-punctuation" style="color:#905">=</span><span class="token script language-javascript" style="color:#999">{</span><span class="token script language-javascript" style="color:#905">closeModal</span><span class="token script language-javascript" style="color:#999">}</span><span class="token" style="color:#905"> </span><span class="token" style="color:#690">style</span><span class="token script language-javascript script-punctuation" style="color:#905">=</span><span class="token script language-javascript" style="color:#999">{</span><span class="token script language-javascript" style="color:#999">{</span><span class="token script language-javascript" style="color:#905"> backgroundColor</span><span class="token script language-javascript" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span class="token script language-javascript" style="color:#905"> </span><span class="token script language-javascript" style="color:#690">&#x27;rgba(0, 0, 0, 0.8)&#x27;</span><span class="token script language-javascript" style="color:#905"> </span><span class="token script language-javascript" style="color:#999">}</span><span class="token script language-javascript" style="color:#999">}</span><span class="token" style="color:#905"> </span><span class="token" style="color:#999">/&gt;</span><span class="token plain-text">
</span><span class="token plain-text">        </span><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#905">div</span><span class="token" style="color:#905"> </span><span class="token" style="color:#690">className</span><span class="token attr-equals" style="color:#999">=</span><span class="token" style="color:#999">&quot;</span><span class="token" style="color:#07a">general-modal-content</span><span class="token" style="color:#999">&quot;</span><span class="token" style="color:#905"> </span><span class="token" style="color:#690">style</span><span class="token script language-javascript script-punctuation" style="color:#905">=</span><span class="token script language-javascript" style="color:#999">{</span><span class="token script language-javascript" style="color:#905">childrenCss</span><span class="token script language-javascript" style="color:#999">}</span><span class="token" style="color:#999">&gt;</span><span class="token plain-text">
</span><span class="token plain-text">          </span><span class="token" style="color:#999">{</span><span>children</span><span class="token" style="color:#999">}</span><span class="token plain-text">
</span><span class="token plain-text">        </span><span class="token" style="color:#999">&lt;/</span><span class="token" style="color:#905">div</span><span class="token" style="color:#999">&gt;</span><span class="token plain-text">
</span><span class="token plain-text">      </span><span class="token" style="color:#999">&lt;/</span><span class="token" style="color:#DD4A68">StyledGeneralModal</span><span class="token" style="color:#999">&gt;</span><span class="token plain-text">
</span><span class="token plain-text">    </span><span class="token" style="color:#999">&lt;/</span><span class="token" style="color:#DD4A68">PortalToModalRootComposition</span><span class="token" style="color:#999">&gt;</span><span>
</span><span>  </span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token module" style="color:#07a">default</span><span> </span><span class="token maybe-class-name">React</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">memo</span><span class="token" style="color:#999">(</span><span class="token maybe-class-name">GeneralModalComposition</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><h1>GeneralModalComposition.style.ts</h1><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-tsx" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports">styled</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;@emotion/styled&#x27;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports" style="color:#999">{</span><span class="token imports"> keyframes </span><span class="token imports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;@emotion/react&#x27;</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> fadeIn </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> keyframes</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string css language-css">
</span><span class="token template-string css language-css">  </span><span class="token template-string css language-css" style="color:#690">from</span><span class="token template-string css language-css"> </span><span class="token template-string css language-css" style="color:#999">{</span><span class="token template-string css language-css">
</span><span class="token template-string css language-css">    </span><span class="token template-string css language-css" style="color:#905">opacity</span><span class="token template-string css language-css" style="color:#999">:</span><span class="token template-string css language-css"> </span><span class="token template-string css language-css" style="color:#905">0</span><span class="token template-string css language-css" style="color:#999">;</span><span class="token template-string css language-css">
</span><span class="token template-string css language-css">  </span><span class="token template-string css language-css" style="color:#999">}</span><span class="token template-string css language-css">
</span><span class="token template-string css language-css">  </span><span class="token template-string css language-css" style="color:#690">to</span><span class="token template-string css language-css"> </span><span class="token template-string css language-css" style="color:#999">{</span><span class="token template-string css language-css">
</span><span class="token template-string css language-css">    </span><span class="token template-string css language-css" style="color:#905">opacity</span><span class="token template-string css language-css" style="color:#999">:</span><span class="token template-string css language-css"> </span><span class="token template-string css language-css" style="color:#905">1</span><span class="token template-string css language-css" style="color:#999">;</span><span class="token template-string css language-css">
</span><span class="token template-string css language-css">  </span><span class="token template-string css language-css" style="color:#999">}</span><span class="token template-string css language-css">
</span><span class="token template-string css language-css"></span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> fadeOut </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> keyframes</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string css language-css">
</span><span class="token template-string css language-css">  </span><span class="token template-string css language-css" style="color:#690">from</span><span class="token template-string css language-css"> </span><span class="token template-string css language-css" style="color:#999">{</span><span class="token template-string css language-css">
</span><span class="token template-string css language-css">    </span><span class="token template-string css language-css" style="color:#905">opacity</span><span class="token template-string css language-css" style="color:#999">:</span><span class="token template-string css language-css"> </span><span class="token template-string css language-css" style="color:#905">1</span><span class="token template-string css language-css" style="color:#999">;</span><span class="token template-string css language-css">
</span><span class="token template-string css language-css">  </span><span class="token template-string css language-css" style="color:#999">}</span><span class="token template-string css language-css">
</span><span class="token template-string css language-css">  </span><span class="token template-string css language-css" style="color:#690">to</span><span class="token template-string css language-css"> </span><span class="token template-string css language-css" style="color:#999">{</span><span class="token template-string css language-css">
</span><span class="token template-string css language-css">    </span><span class="token template-string css language-css" style="color:#905">opacity</span><span class="token template-string css language-css" style="color:#999">:</span><span class="token template-string css language-css"> </span><span class="token template-string css language-css" style="color:#905">0</span><span class="token template-string css language-css" style="color:#999">;</span><span class="token template-string css language-css">
</span><span class="token template-string css language-css">  </span><span class="token template-string css language-css" style="color:#999">}</span><span class="token template-string css language-css">
</span><span class="token template-string css language-css"></span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">const</span><span> </span><span class="token maybe-class-name">StyledGeneralModal</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> styled</span><span class="token" style="color:#999">.</span><span class="token property-access">div</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#999">{</span><span> isOpen</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">boolean</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">
</span><span class="token template-string" style="color:#690">  label: general-modal;
</span><span class="token template-string" style="color:#690">
</span><span class="token template-string" style="color:#690">  position: fixed;
</span><span class="token template-string" style="color:#690">  top: 0;
</span><span class="token template-string" style="color:#690">  left: 0;
</span><span class="token template-string" style="color:#690">  right: 0;
</span><span class="token template-string" style="color:#690">  bottom: 0;
</span><span class="token template-string" style="color:#690">
</span><span class="token template-string" style="color:#690">  display: flex;
</span><span class="token template-string" style="color:#690">  flex-direction: column;
</span><span class="token template-string" style="color:#690">  justify-content: center;
</span><span class="token template-string" style="color:#690">  align-items: center;
</span><span class="token template-string" style="color:#690">  z-index: 99;
</span><span class="token template-string" style="color:#690">
</span><span class="token template-string" style="color:#690">  &gt; .general-modal-content {
</span><span class="token template-string" style="color:#690">    z-index: 1;
</span><span class="token template-string" style="color:#690">    max-width: 90%;
</span><span class="token template-string" style="color:#690">    max-height: 90vh;
</span><span class="token template-string" style="color:#690">
</span><span class="token template-string" style="color:#690">    &amp;::-webkit-scrollbar {
</span><span class="token template-string" style="color:#690">      display: none;
</span><span class="token template-string" style="color:#690">    }
</span><span class="token template-string" style="color:#690">  }
</span><span class="token template-string" style="color:#690">
</span><span class="token template-string" style="color:#690">  animation: </span><span class="token template-string interpolation interpolation-punctuation" style="color:#999">${</span><span class="token template-string interpolation" style="color:#999">(</span><span class="token template-string interpolation" style="color:#999">{</span><span class="token template-string interpolation"> isOpen </span><span class="token template-string interpolation" style="color:#999">}</span><span class="token template-string interpolation" style="color:#999">)</span><span class="token template-string interpolation"> </span><span class="token template-string interpolation arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span class="token template-string interpolation"> </span><span class="token template-string interpolation" style="color:#999">(</span><span class="token template-string interpolation">isOpen </span><span class="token template-string interpolation" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">?</span><span class="token template-string interpolation"> fadeIn </span><span class="token template-string interpolation" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span class="token template-string interpolation"> fadeOut</span><span class="token template-string interpolation" style="color:#999">)</span><span class="token template-string interpolation interpolation-punctuation" style="color:#999">}</span><span class="token template-string" style="color:#690"> 0.5s;
</span><span class="token template-string" style="color:#690"></span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">;</span></code></pre><h1>PortalToModalRootComposition.tsx</h1><p>React Portal을 사용한 컴포지션 패턴의 컴포넌트.
fade out 애니메이션 발생 시 깜빡 거리는 문제를 해결하기 위해 container ref를 사용.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-tsx" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports maybe-class-name">React</span><span class="token imports" style="color:#999">,</span><span class="token imports"> </span><span class="token imports" style="color:#999">{</span><span class="token imports"> useEffect</span><span class="token imports" style="color:#999">,</span><span class="token imports"> useRef </span><span class="token imports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;react&#x27;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports maybe-class-name">ReactDom</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;react-dom&#x27;</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> modalRoot </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token dom" style="color:#e90">document</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">getElementById</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&#x27;modal-root&#x27;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">ModalCompositionPortalProps</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  children</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">React</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">ReactNode</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:slategray">/**
</span><span class="token" style="color:slategray"> * @description
</span><span class="token" style="color:slategray"> * Portal Composition
</span><span class="token" style="color:slategray"> * index.html의 &lt;div id=&quot;modal-root&quot;&gt;&lt;/div&gt; 내부로 children을 이동
</span><span class="token" style="color:slategray"> * @example
</span><span class="token" style="color:slategray"> * &lt;PortalToModalRootComposition&gt;
</span><span class="token" style="color:slategray"> *  { 임의의 Modal 컴포넌트 }
</span><span class="token" style="color:slategray"> * &lt;/PortalToModalRootComposition&gt;
</span><span class="token" style="color:slategray"> */</span><span>
</span><span></span><span class="token" style="color:#07a">function</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">PortalToModalRootComposition</span><span class="token" style="color:#999">(</span><span class="token parameter" style="color:#999">{</span><span class="token parameter"> children </span><span class="token parameter" style="color:#999">}</span><span class="token parameter" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span class="token parameter"> </span><span class="token parameter maybe-class-name">ModalCompositionPortalProps</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#07a">const</span><span> container </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token dom" style="color:#e90">document</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">createElement</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&#x27;div&#x27;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:slategray">// container를 ref로 관리하여, fadeout render 시점 문제 해결</span><span>
</span><span>  </span><span class="token" style="color:#07a">const</span><span> containerRef </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token generic-function" style="color:#DD4A68">useRef</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token generic-function generic maybe-class-name" style="color:#DD4A68">HTMLDivElement</span><span class="token generic-function generic" style="color:#DD4A68"> </span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token generic-function generic" style="color:#DD4A68"> </span><span class="token generic-function generic null nil" style="color:#07a">null</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">(</span><span>container</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>  </span><span class="token" style="color:#DD4A68">useEffect</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token control-flow" style="color:#07a">if</span><span> </span><span class="token" style="color:#999">(</span><span>containerRef</span><span class="token" style="color:#999">.</span><span class="token property-access">current</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">!==</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">)</span><span> modalRoot</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">?.</span><span class="token method property-access" style="color:#DD4A68">appendChild</span><span class="token" style="color:#999">(</span><span>containerRef</span><span class="token" style="color:#999">.</span><span class="token property-access">current</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>      </span><span class="token control-flow" style="color:#07a">if</span><span> </span><span class="token" style="color:#999">(</span><span>containerRef</span><span class="token" style="color:#999">.</span><span class="token property-access">current</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">!==</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">)</span><span> modalRoot</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">?.</span><span class="token method property-access" style="color:#DD4A68">removeChild</span><span class="token" style="color:#999">(</span><span>containerRef</span><span class="token" style="color:#999">.</span><span class="token property-access">current</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span>containerRef</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>  </span><span class="token control-flow" style="color:#07a">if</span><span> </span><span class="token" style="color:#999">(</span><span>containerRef</span><span class="token" style="color:#999">.</span><span class="token property-access">current</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token maybe-class-name">ReactDom</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">createPortal</span><span class="token" style="color:#999">(</span><span>children</span><span class="token" style="color:#999">,</span><span> containerRef</span><span class="token" style="color:#999">.</span><span class="token property-access">current</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span>
</span><span>  </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token module" style="color:#07a">default</span><span> </span><span class="token maybe-class-name">React</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">memo</span><span class="token" style="color:#999">(</span><span class="token maybe-class-name">PortalToModalRootComposition</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><h1>index.html</h1><p>id가 modal-root인 div 태그 추가</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-html" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#999">&lt;!</span><span class="token doctype-tag" style="color:slategray">DOCTYPE</span><span class="token" style="color:slategray"> </span><span class="token name" style="color:slategray">html</span><span class="token" style="color:#999">&gt;</span><span>
</span><span></span><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#905">html</span><span class="token" style="color:#905"> </span><span class="token" style="color:#690">lang</span><span class="token attr-equals" style="color:#999">=</span><span class="token" style="color:#999">&quot;</span><span class="token" style="color:#07a">en</span><span class="token" style="color:#999">&quot;</span><span class="token" style="color:#999">&gt;</span><span>
</span><span>	</span><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#905">head</span><span class="token" style="color:#999">&gt;</span><span>
</span><span>    </span><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#905">title</span><span class="token" style="color:#999">&gt;</span><span>...</span><span class="token" style="color:#999">&lt;/</span><span class="token" style="color:#905">title</span><span class="token" style="color:#999">&gt;</span><span>
</span><span>	</span><span class="token" style="color:#999">&lt;/</span><span class="token" style="color:#905">head</span><span class="token" style="color:#999">&gt;</span><span>
</span><span>	</span><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#905">body</span><span class="token" style="color:#999">&gt;</span><span>
</span><span>		</span><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#905">noscript</span><span class="token" style="color:#999">&gt;</span><span>You need to enable JavaScript to run this app.</span><span class="token" style="color:#999">&lt;/</span><span class="token" style="color:#905">noscript</span><span class="token" style="color:#999">&gt;</span><span>
</span><span>		</span><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#905">div</span><span class="token" style="color:#905"> </span><span class="token" style="color:#690">id</span><span class="token attr-equals" style="color:#999">=</span><span class="token" style="color:#999">&quot;</span><span class="token" style="color:#07a">root</span><span class="token" style="color:#999">&quot;</span><span class="token" style="color:#999">&gt;</span><span class="token" style="color:#999">&lt;/</span><span class="token" style="color:#905">div</span><span class="token" style="color:#999">&gt;</span><span>
</span><span>		</span><span class="token" style="color:#999">&lt;</span><span class="token" style="color:#905">div</span><span class="token" style="color:#905"> </span><span class="token" style="color:#690">id</span><span class="token attr-equals" style="color:#999">=</span><span class="token" style="color:#999">&quot;</span><span class="token" style="color:#07a">modal-root</span><span class="token" style="color:#999">&quot;</span><span class="token" style="color:#999">&gt;</span><span class="token" style="color:#999">&lt;/</span><span class="token" style="color:#905">div</span><span class="token" style="color:#999">&gt;</span><span>
</span><span>	</span><span class="token" style="color:#999">&lt;/</span><span class="token" style="color:#905">body</span><span class="token" style="color:#999">&gt;</span><span>
</span><span></span><span class="token" style="color:#999">&lt;/</span><span class="token" style="color:#905">html</span><span class="token" style="color:#999">&gt;</span></code></pre></div></main></div><div></div><footer class="jsx-a6af0e2473afc2ae"><div class="jsx-a6af0e2473afc2ae copyright">Copyright 2021. <!-- -->FE는 철<!-- --> all rights reserved.</div></footer></div><style data-emotion="css-global 9v2qpw">body{color:#333;background-color:#FFFFFF;}</style></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postInfo":{"id":1645455600,"title":"모달 컴포넌트와 z-index, React Portal","author":"jangky000","category":"업무 회고","desc":"현재 프로젝트에서 사용되고 있던 모달 컴포넌트를 알아보고, React Portal을 사용하여 개선해보자","date":"2022.02.22","content":"\n# 모달 컴포넌트\n\n여기서 말하고자 하는 모달창은 어떠한 사용자의 행동에 대한 응답으로 화면의 최상단에 띄워져야 할 윈도우 창이 아닌 레이어를 말한다. 가장 최상단에 html 요소를 표현하기 위해서는 z-index라는 css 속성을 이해할 필요가 있다.\n\n## z-index의 특징\n\nz-index 속성의 가장 큰 특징은 부모 element의 z-index가 다른 형제 element들의 z-index보다 낮을 때, 아무리 자식 element의 z-index 값을 크게 해도 최상단에 보이지 않는다는 점이다. 이는 쌓임맥락(Stacking Context)을 참고하면 이해가 될 것이다.(참고: [쌓임맥락](https://developer.mozilla.org/ko/docs/Web/CSS/CSS_Positioning/Understanding_z_index/The_stacking_context))\n\n## 기존 모달 컴포넌트\n\n기존에 프로젝트에서 사용되고 있는 모달 컴포넌트 역시 이 z-index로 인한 고민이 있었을 것이다. 특히 컴포넌트 단위로 개발하는 리액트의 작업 방식의 특성상, 모달 컴포넌트가 어떤 z-index를 가진 컴포넌트 내부에서 사용될지 알 수 없기 때문에 z-index의 설정에 대한 고민이 있었을 것이다.\n\n## 기존 모달 컴포넌트 구현 방식\n\n부모 element의 z-index에 영향을 받지 않기 위해, Route 아래에서 GlobalModal 컴포넌트를 아래와 같이 선언했다. 그리고 전역 상태로 모달창을 켜고 끄게 설계되었다.\n\n```tsx\n\u003cSwitch\u003e\n  \u003cRoute exact path=\"/...\" component={...} /\u003e\n\t...\n\u003c/Switch\u003e\n\u003cGlobalModal /\u003e\n```\n\n## 기존 모달 컴포넌트의 문제점\n\n1. 가장 큰 문제점은 모달 컴포넌트 자체에서 background-color: #fff, border-radius: 12px로 고정되어 있는 것이 문제였다. 아래와 같은 디자인을 반영하고 싶어도, 2개의 박스를 표현할 수 없고, 배경 색상을 변경할 수도 없었다. \n\n\u003cimg width=\"70%\" alt=\"1\" src=\"https://user-images.githubusercontent.com/46799722/157811178-4ddc996d-d9f1-4dee-9207-13aa39d55d3b.png\"\u003e\n\u003cimg width=\"25%\" alt=\"2\" src=\"https://user-images.githubusercontent.com/46799722/157811183-1ecfa4a8-0896-461f-87e8-275575b96ad4.png\"\u003e\n\n2. 아래 사용법을 보면 모달 컴포넌트 내부에 들어갈 내용을 컴포넌트로 전달하고 있다. modalStore는 모달의 open, close 전역 상태를 관리하는 mobx의 observable state다. 또한 onClick 이벤트 핸들러 함수 내부에 컴포넌트가 사용되었다. 이에 대해서 핸들러 기능과 컴포넌트 UI의 분리적인 측면에서 개선될 여지가 있다고 생각했다.\n\n```tsx\n// 사용법\n\u003cbutton\n  onClick={() =\u003e\n    modalStore.open(\n      \u003cModalPresenter\n        data={data}\n        handleClick={() =\u003e ...}\n        close={() =\u003e modalStore.hide()}\n      /\u003e,\n      {\n        disableClose: true,\n      },\n    )\n  }\n\u003e\n  ...\n\u003c/button\u003e\n```\n\n## 개선점\n\n기존의 모달 컴포넌트는 많은 곳에서 사용되고 있다. 단순히 옵션 추가와 분기 처리만으로도 필요한 디자인을 만들 수 있겠지만, 점점 많아지는 예외적인 분기처리 코드를 의도를 알기 어렵게 만들고 읽기 어렵게 한다는 생각이 든다. 그래서 새롭게 만드는 기능들부터 쉽게 적용 가능하고, 다양하게 쓰일 수 있는 모달 컴포넌트를 제작하기로 했다.\n\n1. React 자체 기능인 Portal을 이용하여, 전역 상태 관리를 하지 않고 z-index 문제를 해결한다.(참고: [React Portals](https://ko.reactjs.org/docs/portals.html))\n2. background-color와 border-radius 속성을 고정하지 않고 children을 통해 자유롭게 전달할 수 있게 한다.\n3. fade in, fade out 애니메이션을 적용한다.\n\n## 개선 결과: GeneralModalComposition\n\n일반적인 컴포넌트가 `div#root` 내부에 추가되고, Portal을 사용한 컴포넌트는 형제 element인 `div#modal-root` 내부에 추가된다. 그렇게 되면 `div#modal-root` 내부에 있는 modal의 z-index는 `div#root` 내부에 있는 부모 컴포넌트 z-index에 영향을 받지 않는다. 그러므로 modal의 z-index만 값만 고려해서 충분히 할당하면 된다.(여기서는 99)\n\n여기서 주의할 점은 `div#modal-root` 내부에 있는 modal에 z-index 값을 주지 않으면, `div#root` 내부에 있는 z-index가 더 높은 element가 더 상위에 보이게 된다. `div#modal-root` 내부에 있는 modal이 부모 element의 쌓임맥락에 동화되지 않을 뿐이지 z-index 비교는 그대로 하기 때문이다.\n\n\u003cimg width=\"35%\" alt=\"3\" src=\"https://user-images.githubusercontent.com/46799722/157811185-5f417b2d-73c0-4c32-9b54-111ff7f3d93f.png\"\u003e\n\u003cimg width=\"60%\" alt=\"4\" src=\"https://user-images.githubusercontent.com/46799722/157811188-4993ac48-9b6a-46d4-95f8-0550835928df.png\"\u003e\n\n## GeneralModalComposition 사용법\n\n버튼의 클릭 이벤트 핸들러와 모달 내부의 컴포넌트가 분리가 되었다. 그리고 전역 상태로 관리하지 않고도 모달 컴포넌트를 최상단에 그릴 수 있게 되었다.\n\n```tsx\nconst [isModalOpen, setModalOpen] = useState(false);\nconst handleModalOpen = useCallback(() =\u003e setLegacyPlanModalOpen(true), []);\nconst handleModalClose = useCallback(() =\u003e setLegacyPlanModalOpen(false), []);\n\nreturn (\n\t\u003cButton onClick={handleModalOpen}\u003e모달 열기\u003c/Button\u003e\n\t\n\t\u003cGeneralModalComposition \n\t\tisOpen={isModalOpen}\n\t\tcloseModal={handleModalClose}\n\t\tchildrenCss={{ width: '1352px', height: '1607px' }} -\u003e optional\n\t\u003e\n\t\t{ 임의의 Modal 컴포넌트 }\n\t\u003c/GeneralModalComposition\u003e\n\t)\n```\n\n# GeneralModalComposition.tsx\n\n배경에 Backdrop 추가.\nfadeIn, fadeOut animation 적용.\n\n```tsx\ninterface GeneralModalCompositionProps {\n  isOpen: boolean;\n  closeModal: () =\u003e void;\n  children: React.ReactNode;\n  childrenCss?: React.CSSProperties;\n}\n/**\n * @description\n * Composition\n * @example\n * \u003cButton onClick={handleModalOpen}\u003e모달 열기\u003c/Button\u003e\n *\n * \u003cGeneralModalComposition\n    isOpen={isModalOpen}\n    childrenCss={{ width: '1352px', height: '1607px' }}\n    closeModal={handleModalClose}\n  \u003e\n *  { 임의의 Modal 컴포넌트 }\n * \u003c/GeneralModalComposition\u003e\n */\nfunction GeneralModalComposition({ isOpen, closeModal, children, childrenCss }: GeneralModalCompositionProps) {\n  const [isVisible, setVisible] = useState(false);\n\n  useEffect(() =\u003e {\n    if (isOpen) {\n      setVisible(true);\n    } else {\n      setTimeout(() =\u003e setVisible(false), 100);\n    }\n  }, [isOpen]);\n\n  if (!isVisible) {\n    return null;\n  }\n\n  return (\n    \u003cPortalToModalRootComposition\u003e\n      \u003cStyledGeneralModal isOpen={isOpen}\u003e\n        \u003cBackdrop handleClick={closeModal} style={{ backgroundColor: 'rgba(0, 0, 0, 0.8)' }} /\u003e\n        \u003cdiv className=\"general-modal-content\" style={childrenCss}\u003e\n          {children}\n        \u003c/div\u003e\n      \u003c/StyledGeneralModal\u003e\n    \u003c/PortalToModalRootComposition\u003e\n  );\n}\n\nexport default React.memo(GeneralModalComposition);\n```\n\n# GeneralModalComposition.style.ts\n\n```tsx\nimport styled from '@emotion/styled';\nimport { keyframes } from '@emotion/react';\n\nconst fadeIn = keyframes`\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n`;\n\nconst fadeOut = keyframes`\n  from {\n    opacity: 1;\n  }\n  to {\n    opacity: 0;\n  }\n`;\n\nexport const StyledGeneralModal = styled.div\u003c{ isOpen: boolean }\u003e`\n  label: general-modal;\n\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  z-index: 99;\n\n  \u003e .general-modal-content {\n    z-index: 1;\n    max-width: 90%;\n    max-height: 90vh;\n\n    \u0026::-webkit-scrollbar {\n      display: none;\n    }\n  }\n\n  animation: ${({ isOpen }) =\u003e (isOpen ? fadeIn : fadeOut)} 0.5s;\n`;\n```\n\n# PortalToModalRootComposition.tsx\n\nReact Portal을 사용한 컴포지션 패턴의 컴포넌트.\nfade out 애니메이션 발생 시 깜빡 거리는 문제를 해결하기 위해 container ref를 사용.\n\n```tsx\nimport React, { useEffect, useRef } from 'react';\nimport ReactDom from 'react-dom';\n\nconst modalRoot = document.getElementById('modal-root');\n\ninterface ModalCompositionPortalProps {\n  children: React.ReactNode;\n}\n/**\n * @description\n * Portal Composition\n * index.html의 \u003cdiv id=\"modal-root\"\u003e\u003c/div\u003e 내부로 children을 이동\n * @example\n * \u003cPortalToModalRootComposition\u003e\n *  { 임의의 Modal 컴포넌트 }\n * \u003c/PortalToModalRootComposition\u003e\n */\nfunction PortalToModalRootComposition({ children }: ModalCompositionPortalProps) {\n  const container = document.createElement('div');\n  // container를 ref로 관리하여, fadeout render 시점 문제 해결\n  const containerRef = useRef\u003cHTMLDivElement | null\u003e(container);\n\n  useEffect(() =\u003e {\n    if (containerRef.current !== null) modalRoot?.appendChild(containerRef.current);\n    return () =\u003e {\n      if (containerRef.current !== null) modalRoot?.removeChild(containerRef.current);\n    };\n  }, [containerRef]);\n\n  if (containerRef.current) {\n    return ReactDom.createPortal(children, containerRef.current);\n  }\n  return null;\n}\n\nexport default React.memo(PortalToModalRootComposition);\n```\n\n# index.html\n\nid가 modal-root인 div 태그 추가\n\n```html\n\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"en\"\u003e\n\t\u003chead\u003e\n    \u003ctitle\u003e...\u003c/title\u003e\n\t\u003c/head\u003e\n\t\u003cbody\u003e\n\t\t\u003cnoscript\u003eYou need to enable JavaScript to run this app.\u003c/noscript\u003e\n\t\t\u003cdiv id=\"root\"\u003e\u003c/div\u003e\n\t\t\u003cdiv id=\"modal-root\"\u003e\u003c/div\u003e\n\t\u003c/body\u003e\n\u003c/html\u003e\n```\n"}},"__N_SSG":true},"page":"/posts/[title]","query":{"title":"모달컴포넌트와z-index,ReactPortal"},"buildId":"bQcpHPUJVgYV3XLMVBb_b","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>